(()=>{var e={};e.id=897,e.ids=[897],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},31438:e=>{"use strict";e.exports=require("node-appwrite")},27790:e=>{"use strict";e.exports=require("assert")},61212:e=>{"use strict";e.exports=require("async_hooks")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},27920:e=>{"use strict";e.exports=require("diagnostics_channel")},82266:e=>{"use strict";e.exports=require("domain")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},66302:e=>{"use strict";e.exports=require("inspector")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},72750:(e,t,s)=>{"use strict";let r;s.r(t),s.d(t,{default:()=>w,generateImageMetadata:()=>b,generateMetadata:()=>j,generateViewport:()=>y}),s(19020);var a=s(23808),n=s(87394),i=s(35247),o=s(54580),l=s(20830),c=s(82811),d=s(48019),m=s(5425),u=s(170);let x=(0,s(85418).createProxy)(String.raw`/Users/kaveh/Horizon-bank/banking/components/StatementFilters.tsx#StatementFilters`);var p=s(5017),h=s(22470),g=s(2732);let f=()=>{let e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0);return{from:t.toISOString().slice(0,10),to:s.toISOString().slice(0,10)}},v=(e,t)=>{let s=new URLSearchParams;return Object.entries(t).forEach(([e,t])=>{t&&s.set(e,t)}),`${e}?${s.toString()}`};r=new Proxy(async function({searchParams:e}){let t=await (0,h.getLoggedInUser)();if(!t)return null;let s=await (0,p.getAccounts)({userId:t.$id});if(!s?.data?.length)return(0,l.jsx)("div",{className:"transactions",children:(0,l.jsx)(c.Z,{title:"Statements",subtext:"No accounts available."})});let r=f(),a=e.id||s.data[0].appwriteItemId,n={from:e.from||r.from,to:e.to||r.to},i=e.direction||"all",o=await (0,p.getAccount)({appwriteItemId:a}),j=o?.transactions||[],b=(0,g.X4)(j,{from:n.from,to:n.to,direction:i}).slice().sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),y=(0,g.I_)(b,o?.data?.currentBalance||0),w=v("/api/statements/pdf",{bankId:a,from:n.from,to:n.to,direction:"all"!==i?i:void 0}),N=v("/api/transactions/export",{bankId:a,from:n.from,to:n.to,direction:"all"!==i?i:void 0}),k=(0,g.P_)(b,y,{accountName:o?.data?.name||a,officialName:o?.data?.officialName,period:n,direction:i});return(0,l.jsxs)("div",{className:"transactions",children:[(0,l.jsx)("div",{className:"transactions-header",children:(0,l.jsx)(c.Z,{title:"Account Statements",subtext:"Review period summaries, download PDFs, or export CSVs."})}),(0,l.jsxs)("section",{className:"space-y-6",children:[(0,l.jsx)(d.Z,{}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,l.jsx)(x,{accounts:s.data,defaultValues:{bankId:a,from:n.from,to:n.to,direction:i},downloadLinks:{pdf:w,csv:N}}),(0,l.jsx)(u.r,{accounts:s.data,defaultBankId:a})]}),(0,l.jsxs)("div",{className:"grid gap-4 rounded-2xl bg-white p-6 shadow-sm md:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Opening Balance"}),(0,l.jsxs)("p",{className:"text-2xl font-semibold",children:["$",y.openingBalance.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Closing Balance"}),(0,l.jsxs)("p",{className:"text-2xl font-semibold",children:["$",y.closingBalance.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Net Change"}),(0,l.jsxs)("p",{className:`text-2xl font-semibold ${y.netChange>=0?"text-emerald-600":"text-rose-600"}`,children:["$",y.netChange.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Total Credits"}),(0,l.jsxs)("p",{className:"text-xl font-medium text-emerald-600",children:["$",y.totalCredits.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Total Debits"}),(0,l.jsxs)("p",{className:"text-xl font-medium text-rose-600",children:["-$",y.totalDebits.toFixed(2)]})]})]}),(0,l.jsxs)("div",{className:"space-y-4 rounded-2xl bg-white p-6 shadow-sm",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Statement Preview"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Preview the data included in your PDF download."}),(0,l.jsx)("div",{className:"max-h-64 overflow-y-auto rounded border border-gray-200 bg-gray-50 p-4 text-sm font-mono",children:k.map((e,t)=>(0,l.jsx)("p",{className:"whitespace-pre",children:e},`${e}-${t}`))})]}),(0,l.jsxs)("section",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Transactions"}),(0,l.jsx)(m.Z,{transactions:b})]})]})]})},{apply:(e,t,s)=>{let r,l,c;try{let e=o.requestAsyncStorage.getStore();r=(0,a.h)((0,n.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("sentry-trace")]),()=>void 0),l=(0,a.h)((0,n.x)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("baggage")]),()=>void 0),c=(0,n.x)([e,"optionalAccess",e=>e.headers])}catch(e){}return i.D(e,{componentRoute:"/(root)/statements",componentType:"Page",sentryTraceHeader:r,baggageHeader:l,headers:c}).apply(t,s)}});let j=void 0,b=void 0,y=void 0,w=r},32577:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.Z,__next_app__:()=>m,originalPathname:()=>d,pages:()=>c,routeModule:()=>u,tree:()=>l}),s(72750),s(83017),s(22760),s(63835);var r=s(24636),a=s(7773),n=s(86864),i=s(46934),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let l=["",{children:["(root)",{children:["statements",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,72750)),"/Users/kaveh/Horizon-bank/banking/app/(root)/statements/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,83017)),"/Users/kaveh/Horizon-bank/banking/app/(root)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,22760,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,63835)),"/Users/kaveh/Horizon-bank/banking/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,22760,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/kaveh/Horizon-bank/banking/app/(root)/statements/page.tsx"],d="/(root)/statements/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(root)/statements/page",pathname:"/statements",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},47107:(e,t,s)=>{Promise.resolve().then(s.bind(s,14672)),Promise.resolve().then(s.bind(s,85879)),Promise.resolve().then(s.t.bind(s,92949,23))},85879:(e,t,s)=>{"use strict";s.d(t,{StatementFilters:()=>d});var r=s(40612),a=s(50030),n=s(20297),i=s(35326),o=s(82594),l=s(12043);let c=[{value:"all",label:"All transactions"},{value:"credit",label:"Credits (money in)"},{value:"debit",label:"Debits (money out)"}],d=({accounts:e,defaultValues:t,downloadLinks:s})=>{let d=(0,n.useRouter)(),m=(0,n.usePathname)(),u=(0,n.useSearchParams)(),[x,p]=(0,a.useState)({bankId:t.bankId,from:t.from,to:t.to,direction:t.direction||"all"});return(0,a.useEffect)(()=>{p({bankId:t.bankId,from:t.from,to:t.to,direction:t.direction||"all"})},[t.bankId,t.from,t.to,t.direction]),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new URLSearchParams(u.toString());t.set("id",x.bankId),x.from?t.set("from",x.from):t.delete("from"),x.to?t.set("to",x.to):t.delete("to"),x.direction&&"all"!==x.direction?t.set("direction",x.direction):t.delete("direction"),t.delete("page"),d.push(`${m}?${t.toString()}`,{scroll:!1})},className:"flex w-full flex-col gap-4 rounded-2xl bg-white p-4 shadow-sm md:flex-row md:items-end",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"statement-account",children:"Account"}),(0,r.jsxs)(l.Ph,{value:x.bankId,onValueChange:e=>p(t=>({...t,bankId:e})),children:[r.jsx(l.i4,{id:"statement-account",children:r.jsx(l.ki,{})}),r.jsx(l.Bw,{children:e.map(e=>r.jsx(l.Ql,{value:e.appwriteItemId,children:e.name},e.appwriteItemId))})]})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"statement-from",children:"From"}),r.jsx(o.I,{type:"date",id:"statement-from",value:x.from,onChange:e=>p(t=>({...t,from:e.target.value}))})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"statement-to",children:"To"}),r.jsx(o.I,{type:"date",id:"statement-to",value:x.to,onChange:e=>p(t=>({...t,to:e.target.value}))})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",htmlFor:"statement-direction",children:"Direction"}),(0,r.jsxs)(l.Ph,{value:x.direction||"all",onValueChange:e=>p(t=>({...t,direction:e})),children:[r.jsx(l.i4,{id:"statement-direction",children:r.jsx(l.ki,{})}),r.jsx(l.Bw,{children:c.map(e=>r.jsx(l.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 md:w-[220px]",children:[r.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Actions"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(i.z,{type:"submit",className:"flex-1",children:"Apply"}),r.jsx(i.z,{type:"button",variant:"outline",onClick:()=>{p({bankId:t.bankId,from:t.from,to:t.to,direction:"all"});let e=new URLSearchParams(u.toString());e.set("id",t.bankId),e.delete("from"),e.delete("to"),e.delete("direction"),e.delete("page"),d.push(`${m}?${e.toString()}`,{scroll:!1})},children:"Reset"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx(i.z,{asChild:!0,variant:"ghost",className:"flex-1",children:r.jsx("a",{href:s.csv,download:!0,children:"Export CSV"})}),r.jsx(i.z,{asChild:!0,variant:"ghost",className:"flex-1",children:r.jsx("a",{href:s.pdf,download:!0,children:"Download PDF"})})]})]})]})}},48019:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s(20830),a=s(51066),n=s(72077),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=((e,t)=>{let s=(0,n.forwardRef)(({color:s="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:c="",children:d,...m},u)=>(0,n.createElement)("svg",{ref:u,...i,width:r,height:r,stroke:s,strokeWidth:l?24*Number(a)/Number(r):a,className:["lucide",`lucide-${o(e)}`,c].join(" "),...m},[...t.map(([e,t])=>(0,n.createElement)(e,t)),...Array.isArray(d)?d:[d]]));return s.displayName=`${e}`,s})("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),c=()=>(0,r.jsxs)("section",{className:"legal-banner",children:[(0,r.jsxs)("div",{className:"flex-1 space-y-1",children:[r.jsx("p",{className:"text-sm font-semibold text-brand-700",children:"Regulatory Notice"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Horizon provides digital wealth management services with FDIC-insured sweep programs. Transaction availability may vary by jurisdiction. Please review the latest legal disclosures before completing a transfer."})]}),r.jsx("div",{className:"flex items-center gap-3",children:(0,r.jsxs)(a.default,{className:"legal-banner__cta",href:"/legal/disclaimer",children:["View full disclaimer",r.jsx(l,{className:"h-4 w-4"})]})})]})},2732:(e,t,s)=>{"use strict";s.d(t,{CE:()=>l,I_:()=>i,P_:()=>c,X4:()=>n});let r=e=>(e instanceof Date?e:new Date(e)).toISOString().slice(0,10),a=e=>{let t=e instanceof Date?e:new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate())},n=(e,t)=>{if(!e?.length)return[];let{from:s,to:r,direction:n}=t,i=s?a(s):null,o=r?a(r):null,l=n&&"all"!==n?n:null;return e.filter(e=>{let t=a(e.date);return(!i||!(t<i))&&(!o||!(t>o))&&(!l||(e.direction||e.type)===l)})},i=(e,t)=>{let s=e.reduce((e,t)=>e+t.amount,0);return{totalCredits:e.filter(e=>e.amount>0).reduce((e,t)=>e+t.amount,0),totalDebits:e.filter(e=>e.amount<0).reduce((e,t)=>e+Math.abs(t.amount),0),netChange:s,openingBalance:t-s,closingBalance:t}},o=e=>{if(null==e)return"";let t=String(e);return/[",\n]/.test(t)?`"${t.replace(/"/g,'""')}"`:t},l=(e,t)=>{let{accountName:s,bankId:a,filters:n}=t,i=[["Account",s],["Bank ID",a],["From",n.from?r(n.from):"—"],["To",n.to?r(n.to):"—"],["Direction",n.direction&&"all"!==n.direction?n.direction:"All"],[]],l=e.map(e=>[r(e.date),e.name,e.amount.toFixed(2),e.direction||e.type||"",e.category||"",e.paymentChannel||e.channel||"",e.source||""]);return[...i.map(e=>e.map(o).join(",")),"Date,Description,Amount,Direction,Category,Payment Channel,Source",...l.map(e=>e.map(o).join(","))].join("\n")},c=(e,t,s)=>{let{accountName:a,officialName:n,period:i,direction:o}=s,l=[];return l.push(`Account: ${a}`),n&&l.push(`Institution: ${n}`),l.push(`Statement Period: ${r(i.from)} to ${r(i.to)}`),o&&"all"!==o&&l.push(`Direction: ${o}`),l.push(`Opening Balance: $${t.openingBalance.toFixed(2)}`),l.push(`Closing Balance: $${t.closingBalance.toFixed(2)}`),l.push(`Total Credits: $${t.totalCredits.toFixed(2)}`),l.push(`Total Debits: $${t.totalDebits.toFixed(2)}`),l.push(""),l.push("Date | Description | Amount | Direction | Category"),e.forEach(e=>{let t=r(e.date),s=e.amount.toFixed(2),a=e.direction||e.type||"",n=e.category||"";l.push(`${t} | ${e.name} | ${s} | ${a} | ${n}`)}),l}},51066:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(62909),a=s.n(r)},62909:(e,t,s)=>{"use strict";let{createProxy:r}=s(85418);e.exports=r("/Users/kaveh/Horizon-bank/banking/node_modules/next/dist/client/link.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[50,415,403,640,175,711,473,593,564,17,936,899],()=>s(32577));module.exports=r})();
//# sourceMappingURL=page.js.map